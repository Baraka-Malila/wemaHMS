# CLAUDE.md - Critical Development Context & Rules

## üéØ **Project Overview**

**WEMA Hospital Management System** - A comprehensive, role-based hospital management platform built with modern technologies and real-world workflow implementation.

**Tech Stack**: Django REST + Next.js 15 + PostgreSQL + Redis + Docker
**Architecture**: Containerized microservices with role-based authentication
**Current Status**: 70% complete - Core patient workflow functional, ready for intensive development

---

## üö® **CRITICAL STATUS UPDATE - September 22, 2025**

### **‚ö†Ô∏è KNOWN CRITICAL BUGS (Documented in CRITICAL_BUGS.md)**
1. **Multi-Tab Authentication Confusion** - When multiple tabs open, user context gets mixed between roles
2. **Static Time Display** - Dashboard clocks don't update in real-time

**üîí RESOLUTION STATUS**: Bugs documented and deferred. DO NOT ATTEMPT TO FIX during heavy development phase.
**üéØ PRIORITY**: Complete core functionality first, address bugs in dedicated bug-fix session.

---

## üö® **CRITICAL DEVELOPMENT RULES** (The "Songs" You Keep Singing)

### **1. API Integration First, Always!**
- **"We use REAL APIs, not mock data!"** - Always integrate with backend endpoints
- Replace mock data immediately with actual API calls
- Test API integration before considering a feature "complete"
- If backend API doesn't exist, create it first, then integrate

### **2. Reuse Components, Don't Duplicate**
- **"We already have modals - REUSE them!"** - Use existing `PatientDetailsModal`, `NewPatientModal`, `ExistingPatientModal`
- Check `/components/` before creating new components
- Maintain design consistency across all portals
- Share UI components between similar workflows

### **3. Real Hospital Workflow Logic**
- **"Hospitals work FIFO, not random!"** - Implement proper patient queue logic
- Separate monitoring (Dashboard) from workspace (Queue/Operations)
- Follow actual medical workflow: Registration ‚Üí Check-in ‚Üí Queue ‚Üí Consultation ‚Üí Services
- Patient status flow: `REGISTERED` ‚Üí `FILE_FEE_PAID` ‚Üí `WAITING_DOCTOR` ‚Üí `WITH_DOCTOR` ‚Üí `COMPLETED`

### **4. Fix Errors Immediately**
- **"TypeScript errors? Fix them NOW!"** - Never ignore compilation errors
- Use `git checkout HEAD -- file.tsx` to restore when in doubt
- Check error logs before adding new features
- Test changes before moving to next task

### **5. Docker & Backend Dependencies**
- **"Check the package name!"** - It's `django-filter`, not `django_filters`
- Always check if packages are installed correctly
- Use Docker logs to debug backend issues
- Keep containers running during development

### **üîí 6. Bug Avoidance Rules (Critical)**
- **DO NOT** modify authentication/session management during heavy development
- **DO NOT** attempt to fix multi-tab authentication issues yet
- **IGNORE** time display bugs unless specifically requested  
- **FOCUS** on core patient workflow completion

---

## üéØ **IMMEDIATE DEVELOPMENT PRIORITIES**

### **Phase 1: Complete Patient Workflow (Current Focus)**
1. **Reception Portal** - Patient registration, appointment scheduling
2. **Doctor Portal** - Consultation management, diagnosis, prescriptions
3. **Lab Portal** - Test processing, results management
4. **Pharmacy Portal** - Prescription dispensing, inventory
5. **Nursing Portal** - Patient monitoring, ward management

### **Phase 2: Financial & Administrative**
1. **Finance Portal** - Billing, payments, reports
2. **Admin Portal** - User management, system settings
3. **Reports & Analytics** - Cross-portal reporting

### **Phase 3: Bug Resolution & Polish**
1. Fix multi-tab authentication issues
2. Implement real-time clock components
3. Performance optimization
4. Security enhancements

---

## üíª **Development Standards**

### **Code Quality**
- Follow clean, modular coding practices with clear separation of concerns
- Write descriptive variable names (no single letters except loops)
- Use TypeScript properly - define interfaces for all data structures
- Implement proper error handling with user-friendly messages
- Add loading states for all async operations

### **Component Structure**
```tsx
// Always follow this pattern:
const [loading, setLoading] = useState(false);
const [data, setData] = useState<DataType[]>([]);
const [error, setError] = useState('');

const fetchData = async () => {
  try {
    setLoading(true);
    const response = await fetch(`${API_URL}/endpoint/`);
    if (response.ok) {
      const result = await response.json();
      setData(result);
    }
  } catch (error) {
    setError('Failed to load data');
  } finally {
    setLoading(false);
  }
};
```

### **API Integration Standards**
- Always use `localStorage.getItem('auth_token')` for authentication
- Include proper headers: `Authorization: Token ${token}`, `Content-Type: application/json`
- Handle 401 (unauthorized), 403 (forbidden), 404 (not found) responses
- Use consistent error messaging across components
- Implement proper loading and error states

### **File Organization**
- Keep related functionality in same directory
- Use descriptive file names (`PatientDetailsModal.tsx`, not `Modal.tsx`)
- Place shared types in `/types/index.ts`
- Keep API calls in component files (don't over-abstract)

---

## ü§ù **Collaboration Guidelines**

### **Before Making Changes**
- **Read CLAUDE.md first** - Always reference this file for context
- Check existing implementations before creating new solutions
- Review recent git commits to understand current work
- Ask for clarification if workflow or requirements are unclear

### **When Editing Files**
- Provide clear context about what you're changing and why
- Use `replace_string_in_file` with 3-5 lines of context before/after
- Test changes immediately after implementation
- Explain any complex logic or architectural decisions

### **Error Resolution Process**
1. Check terminal/browser errors first
2. Review recent changes that might have caused the issue
3. Use git to revert problematic changes if needed
4. Fix root cause, not just symptoms
5. Test fix thoroughly before proceeding

### **Communication Style**
- Be concise but complete in explanations
- Show what was changed, not just what will be changed
- Suggest improvements before applying large refactors
- Always explain reasoning for significant architectural decisions

---

## üê≥ **Docker & Deployment**

### **Container Management**
- Keep Dockerfiles minimal and focused
- Use multi-stage builds for production
- Ensure all containers start successfully with `docker-compose up`
- Monitor container logs for errors: `docker-compose logs backend --tail=10`

### **Development Environment**
- Frontend runs on `http://localhost:3000`
- Backend API on `http://localhost:8000`
- Database: PostgreSQL on port 5434
- Redis cache on port 6379

### **Environment Variables**
```bash
# Backend (.env)
DEBUG=1
DB_HOST=db
ALLOWED_HOSTS=localhost,127.0.0.1,0.0.0.0,192.168.180.*

# Frontend (.env.local)
NEXT_PUBLIC_API_URL=http://localhost:8000
```

---

## üìä **Current Implementation Status**

### **‚úÖ Completed & Tested**
- **Reception Portal**: Full patient workflow with real API integration
- **Doctor Portal**: Dashboard (monitoring) + Queue (workspace) with proper FIFO logic
- **Authentication**: Role-based login with employee ID auto-generation
- **Patient Management**: Auto-ID (PAT1, PAT2...), status tracking, cross-portal sharing
- **Modals**: Reusable patient components across all portals

### **üîÑ Next Priorities**
1. **Doctor Workflow**: Complete prescription/lab request pages with API integration
2. **Pharmacy Portal**: Connect existing backend APIs to frontend interface
3. **Lab Portal**: Test results and supply order management
4. **Finance Portal**: Daily operations and billing dashboard

### **‚ö†Ô∏è Common Issues & Solutions**
- **TypeScript errors**: Use proper typing, check for null values
- **API connection issues**: Verify Docker containers are running
- **Component duplication**: Always check existing components first
- **State management**: Use proper loading/error states for all async operations

---

## üè• **Hospital Workflow Context**

### **Patient Flow Implementation**
```
Registration (Reception) ‚Üí File Fee ‚Üí Check-in ‚Üí Queue (Doctor) 
    ‚Üì                       ‚Üì           ‚Üì           ‚Üì
   PAT{ID}            Payment Record  WAITING    WITH_DOCTOR
                                      
Consultation (Doctor) ‚Üí Prescription ‚Üí Lab Tests ‚Üí Completion
        ‚Üì                    ‚Üì            ‚Üì          ‚Üì
   Medical Record      Pharmacy Queue  Lab Queue  COMPLETED
```

### **Role-Based Portal Access**
- **Reception**: Patient registration, check-in, file fee processing
- **Doctor**: Patient queue (FIFO), consultations, prescriptions, lab orders
- **Pharmacy**: Medication dispensing, inventory management
- **Lab**: Test processing, results entry, supply orders
- **Admin**: User management, system monitoring, approvals
- **Finance**: Billing, expenses, payroll, reporting

---

## üìù **Special Notes & Reminders**

### **The Golden Rules**
- **"Always check if it exists first!"** - Components, APIs, functions
- **"Real hospitals use FIFO!"** - Patient processing order matters
- **"Integration over isolation!"** - Connect systems, don't build silos
- **"Test immediately!"** - Don't stack untested changes
- **"Backend first, frontend second!"** - Ensure API exists before frontend

### **When in Doubt**
1. Check this CLAUDE.md file for guidance
2. Look at existing working implementations (Reception portal)
3. Review backend API documentation in `*_API_DOCS.md` files
4. Ask for clarification rather than guessing
5. Use git to revert when things break

### **Success Metrics**
- All features use real API integration (no mock data)
- Patient workflow follows real hospital logic
- Components are reused across portals
- No TypeScript compilation errors
- Docker containers run without issues
- User experience matches actual medical workflows

---

**Remember: We're building a real hospital system, not a demo. Every decision should reflect actual medical practice and real-world workflows.**

## üèóÔ∏è **Project Structure (3 Levels Deep)**

```
WEMA-HMS/
‚îú‚îÄ‚îÄ backend/                          # Django REST API (Python 3.x)
‚îÇ   ‚îú‚îÄ‚îÄ core/                         # Django project settings & configuration
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settings.py               # Main configuration (DB, apps, middleware)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ urls.py                   # API route definitions
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ permissions.py            # Custom permission classes
‚îÇ   ‚îú‚îÄ‚îÄ auth_portal/                  # Authentication & user management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py                 # Custom User model with role-based system
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views.py                  # Login, registration, admin approval
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ urls.py                   # Auth endpoints (/api/auth/)
‚îÇ   ‚îú‚îÄ‚îÄ patients/                     # Patient records & management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py                 # Patient model with auto-ID generation (PAT1, PAT2...)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views.py                  # Patient CRUD, search, status updates
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ urls.py                   # Patient endpoints (/api/patients/)
‚îÇ   ‚îú‚îÄ‚îÄ doctor/                       # Medical consultations & prescriptions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py                 # Consultation, Prescription, LabRequest models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views.py                  # Queue management, consultation workflow
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ urls.py                   # Doctor endpoints (/api/doctor/)
‚îÇ   ‚îú‚îÄ‚îÄ reception/                    # Patient registration & check-in
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py                 # Reception-specific operations
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views.py                  # Registration, file fee, check-in logic
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ urls.py                   # Reception endpoints (/api/reception/)
‚îÇ   ‚îú‚îÄ‚îÄ pharmacy/                     # Medication inventory & dispensing
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py                 # Medication, Inventory, Prescription models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views.py                  # Stock management, prescription processing
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ urls.py                   # Pharmacy endpoints (/api/pharmacy/)
‚îÇ   ‚îú‚îÄ‚îÄ lab/                          # Laboratory tests & results
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py                 # LabTest, LabResult, SupplyOrder models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views.py                  # Test processing, results management
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ urls.py                   # Lab endpoints (/api/lab/)
‚îÇ   ‚îú‚îÄ‚îÄ nursing/                      # Patient care & ward management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py                 # Ward, PatientCare, VitalSigns models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views.py                  # Ward assignments, care documentation
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ urls.py                   # Nursing endpoints (/api/nursing/)
‚îÇ   ‚îú‚îÄ‚îÄ finance/                      # Billing, pricing & payroll
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py                 # ServicePricing, Revenue, StaffSalary models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views.py                  # Financial operations, expense tracking
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ urls.py                   # Finance endpoints (/api/pricing/, /api/expenses/, /api/payroll/)
‚îÇ   ‚îú‚îÄ‚îÄ admin_portal/                 # System administration
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py                 # Admin-specific models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views.py                  # User management, system monitoring
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ urls.py                   # Admin endpoints (/api/admin/)
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt              # Python dependencies
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile                    # Backend containerization
‚îú‚îÄ‚îÄ frontend/                         # Next.js 15.5.2 (React 19, TypeScript)
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app/                      # App Router (Next.js 13+ structure)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (auth)/               # Authentication pages
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login/            # Sign-in page
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ register/         # Sign-up page
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ forgot-password/  # Password reset
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/                # Administrative portal
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/        # Admin overview
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ staff/            # Staff management
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ patients/         # Patient administration
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reception/            # Front desk operations
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/        # Reception overview & patient management
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ register/         # New patient registration
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ payments/         # Payment processing
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ doctor/               # Medical practice portal
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/        # Doctor overview (monitoring only)
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ queue/            # Patient queue (main workspace)
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prescriptions/    # Prescription management
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lab-requests/     # Lab test ordering
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ diagnoses/        # Diagnosis tracking
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ history/          # Patient history
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pharmacy/             # Medication management
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/        # Pharmacy overview
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dispense/         # Prescription dispensing
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ stock/            # Inventory management
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lab/                  # Laboratory operations
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/        # Lab overview
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test-results/     # Results management
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ supply-orders/    # Equipment ordering
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ nursing/              # Patient care portal
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/        # Nursing overview
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ care/             # Patient care documentation
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ wards/            # Ward management
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ finance/              # Financial management
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ dashboard/        # Financial overview
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ daily-ops/        # Daily financial operations
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/               # Reusable React components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/                 # Authentication components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/                   # UI components (buttons, forms, tables)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NewPatientModal.tsx   # Patient registration modal
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ExistingPatientModal.tsx  # Patient search & check-in
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PatientDetailsModal.tsx   # Patient information viewer
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ EditPatientModal.tsx  # Patient information editor
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lib/                      # Utility functions
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types/                    # TypeScript type definitions
‚îÇ   ‚îú‚îÄ‚îÄ package.json                  # Node.js dependencies
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile                    # Frontend containerization
‚îú‚îÄ‚îÄ DESIGNS/                          # UI/UX Design assets
‚îÇ   ‚îú‚îÄ‚îÄ HOSPITAL-SCHEMA.sql           # Database schema documentation
‚îÇ   ‚îî‚îÄ‚îÄ frontend-designs/             # UI mockups and wireframes
‚îú‚îÄ‚îÄ docker-compose.yml                # Multi-container orchestration
‚îî‚îÄ‚îÄ *.md                              # Documentation files
```

---

## üîß **Django Backend Apps (Role Summary)**

### **1. auth_portal**
Custom authentication system with role-based access control. Manages user registration, login, admin approval workflow, and employee ID auto-generation (ADM001, DOC001, etc.).

### **2. patients** 
Core patient records management with auto-generated patient IDs (PAT1, PAT2...). Handles patient creation, updates, status tracking, and cross-portal patient data sharing.

### **3. reception**
Front desk operations including patient registration, file fee payment processing, patient check-in workflow, and reception dashboard statistics.

### **4. doctor**
Medical consultation workflow, patient queue management, prescription creation, lab test requests, and doctor dashboard with FIFO patient processing.

### **5. pharmacy**
Medication inventory management, prescription processing, stock alerts, medication dispensing, and pharmacy operations dashboard.

### **6. lab**
Laboratory test management, result recording, supply ordering, and lab workflow coordination with doctor requests.

### **7. nursing**
Patient care documentation, ward management, vital signs tracking, and nursing workflow coordination.

### **8. finance**
Service pricing management, revenue tracking, expense recording, staff payroll, and financial reporting across all hospital operations.

### **9. admin_portal**
System administration, user management, approval workflows, and hospital-wide monitoring and configuration.

---

## üé® **Next.js Frontend Portals**

### **Authentication Portal (`(auth)/`)**
- **login/** - Staff sign-in with role-based redirection
- **register/** - Self-registration with admin approval required  
- **forgot-password/** - Password reset workflow

### **Reception Portal (`reception/`)**
- **dashboard/** - ‚úÖ **COMPLETED**: Patient management, search, registration, check-in, stats
- **register/** - Patient registration form
- **payments/** - Payment processing interface

### **Doctor Portal (`doctor/`)**
- **dashboard/** - ‚úÖ **COMPLETED**: Overview monitoring (read-only queue view)
- **queue/** - ‚úÖ **COMPLETED**: Main workspace (FIFO patient processing)
- **prescriptions/** - Prescription management
- **lab-requests/** - Lab test ordering
- **diagnoses/** - Diagnosis documentation
- **history/** - Patient medical history

### **Pharmacy Portal (`pharmacy/`)**
- **dashboard/** - Pharmacy overview and metrics
- **dispense/** - Prescription dispensing workflow
- **stock/** - Inventory management

### **Lab Portal (`lab/`)**
- **dashboard/** - Laboratory overview
- **test-results/** - Results entry and management
- **supply-orders/** - Equipment and supply ordering

### **Nursing Portal (`nursing/`)**
- **dashboard/** - Patient care overview
- **care/** - Care documentation
- **wards/** - Ward management

### **Finance Portal (`finance/`)**
- **dashboard/** - Financial overview and reporting
- **daily-ops/** - Daily financial operations

### **Admin Portal (`admin/`)**
- **dashboard/** - System overview and monitoring
- **staff/** - Employee management
- **patients/** - Patient administration

---

## üîó **Integration Notes**

### **Containerization & Infrastructure**
- **Docker Compose** orchestrates 4 services: PostgreSQL, Redis, Django Backend, Next.js Frontend
- **Database**: PostgreSQL 15 with persistent volumes
- **Caching**: Redis 7 for session management and API caching
- **Development**: Hot-reload enabled for both frontend and backend

### **Authentication & Authorization**
- **Token-based auth**: Django REST Framework tokens stored in localStorage
- **Role-based access**: Custom User model with roles (ADMIN, DOCTOR, RECEPTION, etc.)
- **Employee ID system**: Auto-generated IDs by role (DOC001, REC001, etc.)
- **Admin approval**: New registrations require admin approval before activation

### **API Architecture & Endpoints**

#### **Authentication APIs (`/api/auth/`)**
- `POST /login/` - Staff authentication with role-based redirection
- `POST /register/` - Self-registration (requires admin approval)
- `GET /profile/` - Current user information
- `GET /admin/pending-approvals/` - Admin approval workflow

#### **Patient Management APIs (`/api/patients/`)**
- `GET /search/` - ‚úÖ **INTEGRATED**: Patient search across portals
- `GET /{id}/` - Patient details retrieval
- `PATCH /{id}/status/` - ‚úÖ **INTEGRATED**: Status updates (WAITING_DOCTOR, WITH_DOCTOR, etc.)

#### **Reception APIs (`/api/reception/`)**
- `POST /register-patient/` - ‚úÖ **INTEGRATED**: New patient registration with file fee
- `GET /dashboard/` - ‚úÖ **INTEGRATED**: Reception dashboard statistics
- `POST /patients/{id}/check-in/` - ‚úÖ **INTEGRATED**: Patient check-in workflow

#### **Doctor APIs (`/api/doctor/`)**
- `GET /waiting-patients/` - ‚úÖ **INTEGRATED**: FIFO patient queue
- `POST /start-consultation/` - ‚úÖ **INTEGRATED**: Begin patient consultation
- `GET /dashboard/` - ‚úÖ **INTEGRATED**: Doctor dashboard statistics
- `POST /prescriptions/` - Prescription creation
- `POST /lab-requests/` - Lab test ordering

#### **Pharmacy APIs (`/api/pharmacy/`)**
- `GET /prescription-queue/` - Pending prescriptions
- `POST /scan/` - Medication scanning
- `GET /medications/` - Medication inventory
- `POST /stock/restock/` - Stock management

#### **Lab APIs (`/api/lab/`)**
- `GET /patients/` - Lab queue management
- `GET /results/` - Test results management
- `POST /orders/` - Supply ordering

#### **Finance APIs (`/api/pricing/`, `/api/expenses/`, `/api/payroll/`)**
- `GET /pricing/services/` - Service pricing management
- `POST /expenses/record/` - Expense tracking
- `GET /payroll/staff/` - Staff salary management

### **Data Flow & Patient Workflow**
1. **Registration**: Reception registers patient ‚Üí File fee payment ‚Üí Patient gets PAT{ID}
2. **Check-in**: Patient checked in ‚Üí Status: `WAITING_DOCTOR` ‚Üí Appears in doctor queue
3. **Consultation**: Doctor starts consultation ‚Üí Status: `WITH_DOCTOR` ‚Üí Medical workflow
4. **Prescription**: Doctor creates prescription ‚Üí Appears in pharmacy queue
5. **Lab Tests**: Doctor orders tests ‚Üí Appears in lab queue
6. **Completion**: All services completed ‚Üí Patient status updated ‚Üí Financial tracking

### **Component Reusability**
- **Shared Modals**: `PatientDetailsModal`, `NewPatientModal`, `ExistingPatientModal` used across portals
- **UI Components**: Consistent design system with Tailwind CSS and Lucide React icons
- **Type Safety**: Full TypeScript integration with shared type definitions

---

## üìä **Project Status & Completion**

### **‚úÖ Completed (70% Overall)**

#### **Backend (85% Complete)**
- ‚úÖ **Authentication system** - Full role-based auth with admin approval
- ‚úÖ **Patient management** - Auto-ID generation, status tracking, cross-portal sharing
- ‚úÖ **Reception workflow** - Registration, file fee, check-in integration
- ‚úÖ **Doctor workflow** - Queue management, consultation start/stop
- ‚úÖ **Database models** - All core models implemented with relationships
- ‚úÖ **API endpoints** - Core APIs functional and tested
- ‚úÖ **Docker setup** - Full containerization with PostgreSQL and Redis

#### **Frontend (60% Complete)**
- ‚úÖ **Reception portal** - Complete dashboard, patient management, modals
- ‚úÖ **Doctor portal** - Dashboard and queue pages with proper workflow separation
- ‚úÖ **Authentication** - Login/register with role-based routing
- ‚úÖ **Component system** - Reusable modals and UI components
- ‚úÖ **API integration** - Reception and doctor portals fully connected

### **üîÑ In Progress (20%)**
- üîÑ **Pharmacy portal** - Backend complete, frontend needs integration
- üîÑ **Lab portal** - Backend complete, frontend needs integration  
- üîÑ **Doctor workflow** - Prescription/lab request pages need API integration
- üîÑ **Finance portal** - Backend complete, frontend dashboard needed

### **‚ùå Pending (10%)**
- ‚ùå **Admin portal** - System administration interface
- ‚ùå **Nursing portal** - Patient care documentation
- ‚ùå **Reports system** - Financial and operational reporting
- ‚ùå **Advanced features** - Notifications, real-time updates, mobile optimization

---

## üéØ **Next Development Priorities**

### **Immediate (1-2 weeks)**
1. **Complete Doctor portal** - Prescription and lab request pages with API integration
2. **Pharmacy portal integration** - Connect frontend to existing backend APIs
3. **Lab portal integration** - Test results and supply order interfaces

### **Short term (2-4 weeks)**  
4. **Finance portal** - Dashboard and daily operations interface
5. **Admin portal** - User management and system monitoring
6. **Error handling** - Comprehensive error handling and validation

### **Medium term (1-2 months)**
7. **Advanced features** - Real-time notifications, dashboard analytics
8. **Mobile optimization** - Responsive design improvements
9. **Performance optimization** - Caching, database optimization
10. **Testing & QA** - Comprehensive testing suite and documentation

---

## üè• **Hospital Workflow Implementation**

The system successfully implements real hospital workflows with:
- **FIFO patient processing** in doctor queues
- **Role-based access control** ensuring data security
- **Real-time status tracking** across all departments  
- **Financial integration** for service pricing and revenue tracking
- **Cross-portal communication** enabling seamless patient care coordination

**Current state**: Core patient flow from registration to consultation is fully functional. Next phase focuses on completing medication/lab workflows and administrative features.
